# Visualization of Convolutional Filters and Feature Maps 

This project is a visualization tool for convolutional filters and feature maps in deep learning models. Specifically, it focuses on the ResNet50V2 model and allows the user to visualize the feature maps generated by each layer of the model.

## Table of Contents

- [Visualization of Convolutional Filters and Feature Maps](#visualization-of-convolutional-filters-and-feature-maps)
- [Table of Contents](#table-of-contents)
- [About the Project](#about-the-project)
  - [Built With](#built-with)
- [How To Run](#how-to-run)
  - [Install Requirements](#install-requirements)
  - [Run Code](#run-code)
- [Usage](#usage)
- [License](#license)
- [Contact](#contact)

## About the Project

Typically, deep learning neural networks lack transparency, indicating that despite their ability to provide valuable and proficient forecasts, the rationale or mechanism behind a specific prediction remains unclear.

Convolutional neural networks process two-dimensional image data and maintain the spatial relationships of the learned features. The model's two-dimensional filters can be visualized to identify the types of features detected, and activation maps generated by convolutional layers can be analyzed to understand the detected features in a given input image.

In this project, we will discover how to develop simple visualizations for filters and feature maps in a convolutional neural network.

### Built With

The following libraries are used in this project.

- Python 3.8.10
- Keras 2.11.0
- Tensorflow 2.11.0
- Jupyter Notebook

## How To Run

### Install Requirements

- If you want to run the project on your local machine, follow the steps below:
1. It is suggested to create a conda environment. `conda create -n [your-env-name] python=3.8`
2. Go to the project directory
2. Install requirements by running `pip install -r requirements.txt`

- If you want to run the project on Colab, you don't need to install any package because all of them are already installed.

### Run Code

To generate the visualizations, run the Visualization.ipynb notebook cells in order.

## Usage

1. This jupyter notebook first loads the ResNet50V2 model:

![Screenshot 2023-02-16 234133](https://user-images.githubusercontent.com/112625556/219479779-5d4a7bb0-cc29-4569-9237-10dbd392b0fc.png)

2. visualizes the first conv filter (One row for each filter and one column for each channel):

![image](https://user-images.githubusercontent.com/112625556/219479916-76ad0891-2df3-4493-bb4c-c815842f714e.png)

- The dark squares indicate small or inhibitory weights and the light squares represent large or excitatory weights.

3. applies an image to the model, and generates five plots showing the feature maps from the five main blocks of the model:

![image](https://user-images.githubusercontent.com/112625556/219480172-e91b6856-b91d-4d0a-bb38-63b2d00511de.png)

![image](https://user-images.githubusercontent.com/112625556/219480589-c82e246a-5e6e-4e0b-a4aa-9659eb79f700.png)

Note: For brevity, only the first and last feature maps are shown, the rest of the feature maps can be viewed in the .ipynb file.

The feature maps closer to the input of the model capture more fine detail in the image, while those deeper in the model show less detail due to abstraction of features.

*This code can be customized to work with other deep learning models and images. To do this, modify the Visualization.ipynb notebook to load the desired model and image, and adjust the number of feature maps to display.*

## License

This project is licensed under the MIT License.

## Contact

If you have any questions about the implementation of the project, you can send your questions to this email: alrzbqr@gmail.com
